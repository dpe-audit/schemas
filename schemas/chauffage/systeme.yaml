$id: https://schemas.dpe-audit.fr/chauffage/systeme
$schema: https://json-schema.org/draft/2020-12/schema
title: Système de chauffage
type: object
unevaluatedProperties: false
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  installation_id:
    title: Identifiant de l'installation de chauffage associée
    type: string
    format: uuid
  generateur_id:
    title: Identifiant du générateur de chauffage associé
    type: string
    format: uuid
  type:
    title: Type de système
    type: string
    enum: [chauffage_central, chauffage_divise]
  cascade:
    title: Système en cascade
    type: [integer, "null"]
    description: Ordre de priorité (1 pour le premier système, 2 pour le deuxième, etc.). En l'absence de priorité, saisir 0.
    default: null
  reseau:
    $ref: "#/$defs/reseau"
  emetteurs:
    title: Liste des émetteurs associés au système de chauffage
    type: array
    default: []
    items:
      title: Identifiant unique de l'émetteur de chauffage au format UUID
      type: string
      format: uuid
  data:
    $ref: "#/$defs/data"
required:
  - id
  - description
  - installation_id
  - generateur_id
  - type
oneOf:
  - title: Chauffage central avec distribution hydraulique
    type: object
    properties:
      type:
        const: chauffage_central
      reseau:
        type: object
        properties:
          type_distribution:
            const: hydraulique
        required:
          - type_distribution
      emetteurs:
        type: array
        minContains: 1
    required:
      - type
      - reseau
      - emetteurs
  - title: Chauffage central avec distribution aéraulique
    type: object
    properties:
      type:
        const: chauffage_central
      reseau:
        type: object
        properties:
          type_distribution:
            const: aeraulique
        required:
          - type_distribution
      emetteurs:
        type: array
        minContains: 0
        maxContains: 0
    required:
      - type
      - reseau
      - emetteurs
  - title: Chauffage divisé
    type: object
    properties:
      type:
        const: chauffage_divise
      reseau:
        const: null
      emetteurs:
        type: array
        minContains: 0
        maxContains: 0
    required:
      - type
$defs:
  reseau:
    title: Réseau de distribution
    type: [object, "null"]
    default: null
    properties:
      type_distribution:
        title: Type de distribution
        type: string
        enum:
          - hydraulique
          - aeraulique
      presence_fluide_frigorigene:
        title: Distribution avec fluide frigorigène
        type: boolean
        default: false
      presence_circulateur_externe:
        title: Présence d'un circulateur externe
        type: boolean
        default: false
      niveaux_desservis:
        title: Nombre de niveaux desservis par le réseau
        type: integer
        minimum: 1
      isolation:
        title: Isolation du réseau
        type: ["string", "null"]
        enum: [isole, non_isole, null]
        default: null
    required:
      - type_distribution
      - presence_fluide_frigorigene
      - presence_circulateur_externe
      - niveaux_desservis
      - isolation
  data:
    title: Données calculées
    type: object
    readOnly: true
    properties:
      rdim:
        title: Ratio de dimensionnement
        type: number
      int:
        title: Facteur d'intermittence
        type: number
      i0:
        title: Coefficient d'intermittence
        type: number
      ich:
        title: Inverse du rendement du système
        type: number
      rd:
        title: Rendement de distribution
        type: number
      re:
        title: Rendement d'émission
        type: number
      rg:
        title: Rendement de génération
        type: number
      rr:
        title: Rendement de régulation
        type: number
      cef_ch:
        title: Consommation finale de chauffage en kWh/an
        type: number
      cep_ch:
        title: Consommation primaire de chauffage en kWh/an
        type: number
      eges_ch:
        title: Emissions de gaz à effet de serre de chauffage en kgCO2/an
        type: number
      cef_aux:
        title: Consommation finale des auxiliaires en kWh/an
        type: number
      cep_aux:
        title: Consommation primaire des auxiliaires en kWh/an
        type: number
      eges_aux:
        title: Emissions de gaz à effet de serre des auxiliaires en kgCO2/an
        type: number
