$id: https://schemas.dpe-audit.fr/ecs/generateur
$schema: https://json-schema.org/draft/2020-12/schema
title: Générateur d'eau chaude sanitaire
type: object
unevaluatedProperties: false
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  type:
    title: Type de générateur d'eau chaude sanitaire
    type: string
    enum:
      - accumulateur
      - chauffe_eau_instantane
      - chauffe_eau_vertical
      - chauffe_eau_horizontal
      - chaudiere
      - cet_air_ambiant
      - cet_air_exterieur
      - cet_air_extrait
      - pac_double_service
      - poele_bouilleur
      - reseau_chaleur
  energie:
    title: Energie
    type: string
    enum:
      - electricite
      - gaz_naturel
      - gpl
      - fioul
      - charbon
      - bois_buche
      - bois_plaquette
      - bois_granule
      - reseau_chaleur
  volume_stockage:
    title: Volume de stockage en l
    type: number
    minimum: 0
  generateur_collectif:
    title: Présence d'un générateur collectif d'eau chaude sanitaire
    type: boolean
  generateur_multi_batiment:
    title: Présence d'un générateur multi bâtiment
    type: boolean
  generateur_mixte_id:
    title: Identifiant du générateur mixte
    type: ["string", "null"]
    format: uuid
    default: null
  position_volume_chauffe:
    title: Position du générateur à l'intérieur du volume chauffé
    type: boolean
  annee_installation:
    title: Année d'installation connue et justifiée
    type: ["integer", "null"]
    default: null
  type_chaudiere:
    title: Type de chaudière
    type: ["string", "null"]
    enum:
      - chaudiere_murale
      - chaudiere_sol
      - null
    default: null
  pn:
    title: Puissance nominale en kW
    type: ["number", "null"]
    exclusiveMinimum: 0
    default: null
  label:
    title: Label
    type: ["string", "null"]
    enum:
      - ne_performance_a
      - ne_performance_b
      - ne_performance_c
      - null
    default: null
  cop:
    title: Coefficient de performance énergétique
    type: ["number", "null"]
    exclusiveMinimum: 0
    maximum: 10
    default: null
  mode_combustion:
    title: Mode de combustion
    type: ["string", "null"]
    enum:
      - standard
      - basse_temperature
      - condensation
      - null
    default: null
  presence_ventouse:
    title: Présence d'une ventouse
    type: ["boolean", "null"]
    default: null
  pveilleuse:
    title: Puissance de la veilleuse en W
    type: ["number", "null"]
    minimum: 0
    default: null
  qp0:
    title: Pertes à l'arrêt en W
    type: ["number", "null"]
    exclusiveMinimum: 0
    default: null
  rpn:
    title: Rendement à puissance nominale sur PCI en %
    type: ["number", "null"]
    exclusiveMinimum: 0
    maximum: 150
    default: null
required:
  - id
  - description
  - type
  - energie
  - volume_stockage
  - generateur_collectif
  - generateur_multi_batiment
  - position_volume_chauffe
  - annee_installation
allOf:
  - oneOf:
      - title: Générateur électrique
        type: object
        properties:
          energie:
            const: electricite
          type_chaudiere:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
          reseau_chaleur_id:
            const: null
        required:
          - energie
      - title: Générateur à combustion
        type: object
        properties:
          energie:
            type: string
            enum:
              - gaz_naturel
              - gpl
              - fioul
              - charbon
              - bois_buche
              - bois_plaquette
              - bois_granule
          label:
            const: null
          cop:
            const: null
          reseau_chaleur_id:
            const: null
        required:
          - energie
  - oneOf:
      - title: Générateur individuel
        type: object
        properties:
          generateur_collectif:
            const: false
          generateur_multi_batiment:
            const: false
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
        required:
          - generateur_collectif
      - title: Générateur collectif
        type: object
        properties:
          generateur_collectif:
            const: true
          position_volume_chauffe:
            const: false
        required:
          - generateur_collectif
          - position_volume_chauffe
  - oneOf:
      - title: Accumulateur
        type: object
        properties:
          type:
            const: accumulateur
          energie:
            enum: [gaz_naturel, gpl]
          volume_stockage:
            exclusiveMinimum: 0
          type_chaudiere:
            const: null
          generateur_mixte_id:
            const: null
        required:
          - type
          - energie
          - volume_stockage
      - title: Chauffe-eau instantané
        type: object
        properties:
          type:
            const: chauffe_eau_instantane
          energie:
            enum: [gaz_naturel, gpl]
          volume_stockage:
            const: 0
            default: 0
          generateur_mixte_id:
            const: null
        required:
          - type
          - energie
          - volume_stockage
      - title: Chauffe-eau électrique
        type: object
        properties:
          type:
            enum: [chauffe_eau_vertical, chauffe_eau_horizontal]
          energie:
            const: electricite
          generateur_mixte_id:
            const: null
        required:
          - type
          - energie
      - title: Chaudière électrique
        type: object
        properties:
          type:
            const: chaudiere
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Chaudière à combustion
        type: object
        properties:
          type:
            const: chaudiere
          energie:
            enum:
              - gaz_naturel
              - gpl
              - fioul
              - charbon
              - bois_buche
              - bois_plaquette
              - bois_granule
        required:
          - type
          - energie
      - title: Chauffe-eau thermodynamique
        type: object
        properties:
          type:
            enum: [cet_air_ambiant, cet_air_exterieur, cet_air_extrait]
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Pompe à chaleur
        type: object
        properties:
          type:
            const: pac_double_service
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Poêle bouilleur
        type: object
        properties:
          type:
            const: poele_bouilleur
          energie:
            enum: [bois_buche, bois_plaquette, bois_granule]
          reseau_chaleur_id:
            const: null
        required:
          - type
          - energie
      - title: Réseau de chaleur
        type: object
        properties:
          type:
            const: reseau_chaleur
          energie:
            const: reseau_chaleur
          generateur_collectif:
            const: true
        required:
          - type
          - energie
          - generateur_collectif
