$id: https://schemas.dpe-audit.fr/ecs/generateur
$schema: https://json-schema.org/draft/2020-12/schema
title: Générateur d'eau chaude sanitaire
type: object
unevaluatedProperties: false
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  type:
    title: Type de générateur d'eau chaude sanitaire
    type: [string, "null"]
    enum:
      - chauffe_eau
      - chaudiere
      - cet_air_ambiant
      - cet_air_exterieur
      - cet_air_extrait
      - pac_double_service
      - poele_bouilleur
      - reseau_chaleur
      - null
  energie:
    title: Energie
    type: [string, "null"]
    enum:
      - electricite
      - gaz_naturel
      - gpl
      - fioul
      - charbon
      - bois_buche
      - bois_plaquette
      - bois_granule
      - reseau_chaleur
      - null
  annee_installation:
    title: Année d'installation connue et justifiée
    type: ["integer", "null"]
    default: null
  position:
    $ref: "#/$defs/position"
  signaletique:
    $ref: "#/$defs/signaletique"
  data:
    $ref: "#/$defs/data"
required:
  - id
  - description
  - type
  - energie
  - annee_installation
  - position
  - signaletique
oneOf:
  - title: Chaudière à combustion
    type: object
    properties:
      type:
        enum: [chaudiere, poele_bouilleur]
      energie:
        not:
          enum: [electricite, reseau_chaleur]
      position:
        type: object
        properties:
          position_chauffe_eau:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          cop:
            const: null
          label:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Chaudière électrique
    type: object
    properties:
      type:
        const: chaudiere
      energie:
        const: electricite
      position:
        type: object
        properties:
          position_chauffe_eau:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          cop:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Chauffe-eau à combustion
    type: object
    properties:
      type:
        const: chauffe_eau
      energie:
        not:
          enum: [electricite, reseau_chaleur]
      position:
        type: object
        properties:
          generateur_collectif:
            const: false
          generateur_multi_batiment:
            const: false
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          cop:
            const: null
          label:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Chauffe-eau électrique
    type: object
    properties:
      type:
        const: chauffe_eau
      energie:
        const: electricite
      position:
        type: object
        properties:
          generateur_collectif:
            const: false
          generateur_multi_batiment:
            const: false
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          cop:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Chauffe-eau thermodynamique
    type: object
    properties:
      type:
        enum: [cet_air_ambiant, cet_air_exterieur, cet_air_extrait]
      energie:
        const: electricite
      position:
        type: object
        properties:
          position_chauffe_eau:
            const: null
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          label:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: PAC double service
    properties:
      type:
        const: pac_double_service
      energie:
        const: electricite
      position:
        type: object
        properties:
          position_chauffe_eau:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          label:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Réseau de chaleur
    type: object
    properties:
      type:
        const: reseau_chaleur
      energie:
        const: reseau_chaleur
      position:
        type: object
        properties:
          generateur_collectif:
            const: true
          generateur_multi_batiment:
            const: true
          position_volume_chauffe:
            const: false
          generateur_mixte_id:
            const: null
      signaletique:
        type: object
        properties:
          pn:
            const: null
          cop:
            const: null
          label:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
  - title: Générateur collectif inconnu
    type: object
    properties:
      type:
        const: null
      energie:
        const: null
      position:
        type: object
        properties:
          generateur_collectif:
            const: true
          position_volume_chauffe:
            const: false
          position_chauffe_eau:
            const: null
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
      signaletique:
        type: object
        properties:
          volume_stockage:
            const: null
          pn:
            const: null
          cop:
            const: null
          label:
            const: null
          mode_combustion:
            const: null
          presence_ventouse:
            const: null
          pveilleuse:
            const: null
          qp0:
            const: null
          rpn:
            const: null
    required:
      - type
      - energie
      - position
      - signaletique
$defs:
  position:
    title: Position
    type: object
    properties:
      position_chauffe_eau:
        title: Position du chauffe-eau
        type: [string, "null"]
        enum: [chauffe_eau_vertical, chauffe_eau_horizontal, null]
        default: null
      generateur_collectif:
        title: Générateur collectif d'eau chaude sanitaire
        type: boolean
      generateur_multi_batiment:
        title: Générateur multi bâtiment
        type: boolean
      position_volume_chauffe:
        title: Position du générateur à l'intérieur du volume chauffé
        type: boolean
      generateur_mixte_id:
        title: Identifiant du générateur mixte
        type: ["string", "null"]
        format: uuid
        default: null
      reseau_chaleur_id:
        title: Identifiant du réseau de chaleur
        type: ["string", "null"]
        format: uuid
        default: null
    required:
      - generateur_collectif
      - generateur_multi_batiment
      - position_volume_chauffe
  signaletique:
    title: Fiche signalétique
    type: object
    properties:
      volume_stockage:
        title: Volume de stockage en litres
        type: [number, "null"]
        minimum: 0
        default: null
      pn:
        title: Puissance nominale en kW
        type: ["number", "null"]
        exclusiveMinimum: 0
        default: null
      label:
        title: Label
        type: ["string", "null"]
        enum:
          - ne_performance_a
          - ne_performance_b
          - ne_performance_c
          - null
        default: null
      cop:
        title: Coefficient de performance énergétique
        type: ["number", "null"]
        exclusiveMinimum: 0
        maximum: 10
        default: null
      mode_combustion:
        title: Mode de combustion
        type: ["string", "null"]
        enum:
          - standard
          - basse_temperature
          - condensation
          - null
        default: null
      presence_ventouse:
        title: Présence d'une ventouse
        type: ["boolean", "null"]
        default: null
      pveilleuse:
        title: Puissance de la veilleuse en W
        type: ["number", "null"]
        minimum: 0
        default: null
      qp0:
        title: Pertes à l'arrêt en W
        type: ["number", "null"]
        exclusiveMinimum: 0
        default: null
      rpn:
        title: Rendement à puissance nominale sur PCI en %
        type: ["number", "null"]
        exclusiveMinimum: 0
        maximum: 150
        default: null
  data:
    title: Données calculées
    type: object
    readOnly: true
    properties:
      rdim:
        title: Ratio de dimenstionnement
        type: number
      pn:
        title: Puissance nominale en kW
        type: number
      pdim:
        title: Puissance de dimensionnement en kW
        type: number
      pecs:
        title: Puissance de dimensionnement du besoin d'eau chaude sanitaire en kW
        type: number
      cop:
        title: Coefficient de performance énergétique
        type: [number, "null"]
      rpn:
        title: Rendement à pleine charge exprimée en %PCI
        type: [number, "null"]
      qp0:
        title: Pertes à l'arrêt en W
        type: [number, "null"]
      pveilleuse:
        title: Puissance de la veilleuse en W
        type: [number, "null"]
      pertes_generation:
        title: Pertes de génération en kWh/an
        type: number
      pertes_generation_recuperables:
        title: Pertes de génération récupérables en kWh/an
        type: number
      pertes_stockage:
        title: Pertes de stockage intégré en kWh/an
        type: number
      pertes_stockage_recuperables:
        title: Pertes de stockage intégré récupérables en kWh/an
        type: number
