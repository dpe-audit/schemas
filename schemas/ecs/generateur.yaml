$id: https://schemas.dpe-audit.fr/ecs/generateur
$schema: https://json-schema.org/draft/2020-12/schema
title: Générateur d'eau chaude sanitaire
type: object
unevaluatedProperties: false
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  type:
    title: Type de générateur d'eau chaude sanitaire
    type: string
    enum:
      - accumulateur
      - chauffe_eau_instantane
      - chauffe_eau_vertical
      - chauffe_eau_horizontal
      - chaudiere
      - chaudiere_murale
      - chaudiere_sol
      - cet_air_ambiant
      - cet_air_exterieur
      - cet_air_extrait
      - pac_double_service
      - poele_bouilleur
      - reseau_chaleur
  energie:
    title: Energie
    type: string
    enum:
      - electricite
      - gaz_naturel
      - gpl
      - fioul
      - charbon
      - bois_buche
      - bois_plaquette
      - bois_granule
      - reseau_chaleur
  annee_installation:
    title: Année d'installation connue et justifiée
    type: ["integer", "null"]
    default: null
  position:
    $ref: "#/$defs/position"
  signaletique:
    $ref: "#/$defs/signaletique"
required:
  - id
  - description
  - type
  - energie
  - annee_installation
  - position
  - signaletique
$defs:
  position:
    title: Position
    type: object
    properties:
      generateur_collectif:
        title: Générateur collectif d'eau chaude sanitaire
        type: boolean
      generateur_multi_batiment:
        title: Générateur multi bâtiment
        type: boolean
      position_volume_chauffe:
        title: Position du générateur à l'intérieur du volume chauffé
        type: boolean
      generateur_mixte_id:
        title: Identifiant du générateur mixte
        type: ["string", "null"]
        format: uuid
        default: null
      reseau_chaleur_id:
        title: Identifiant du réseau de chaleur
        type: ["string", "null"]
        format: uuid
        default: null
    required:
      - generateur_collectif
      - generateur_multi_batiment
      - position_volume_chauffe
    oneOf:
      - title: Générateur individuel
        type: object
        properties:
          generateur_collectif:
            const: false
          generateur_multi_batiment:
            const: false
          generateur_mixte_id:
            const: null
          reseau_chaleur_id:
            const: null
        required:
          - generateur_collectif
      - title: Générateur collectif
        type: object
        properties:
          generateur_collectif:
            const: true
          position_volume_chauffe:
            const: false
        required:
          - generateur_collectif
          - position_volume_chauffe
  signaletique:
    title: Fiche signalétique
    type: object
    properties:
      volume_stockage:
        title: Volume de stockage en l
        type: number
        minimum: 0
      pn:
        title: Puissance nominale en kW
        type: ["number", "null"]
        exclusiveMinimum: 0
        default: null
      label:
        title: Label
        type: ["string", "null"]
        enum:
          - ne_performance_a
          - ne_performance_b
          - ne_performance_c
          - null
        default: null
      cop:
        title: Coefficient de performance énergétique
        type: ["number", "null"]
        exclusiveMinimum: 0
        maximum: 10
        default: null
      mode_combustion:
        title: Mode de combustion
        type: ["string", "null"]
        enum:
          - standard
          - basse_temperature
          - condensation
          - null
        default: null
      presence_ventouse:
        title: Présence d'une ventouse
        type: ["boolean", "null"]
        default: null
      pveilleuse:
        title: Puissance de la veilleuse en W
        type: ["number", "null"]
        minimum: 0
        default: null
      qp0:
        title: Pertes à l'arrêt en W
        type: ["number", "null"]
        exclusiveMinimum: 0
        default: null
      rpn:
        title: Rendement à puissance nominale sur PCI en %
        type: ["number", "null"]
        exclusiveMinimum: 0
        maximum: 150
        default: null
    required:
      - volume_stockage
allOf:
  - oneOf:
      - title: Générateur électrique
        type: object
        properties:
          energie:
            const: electricite
          type:
            enum:
              - chauffe_eau_instantane
              - chauffe_eau_vertical
              - chauffe_eau_horizontal
              - chaudiere
              - chaudiere_murale
              - chaudiere_sol
          signaletique:
            cop:
              const: null
            mode_combustion:
              const: null
            presence_ventouse:
              const: null
            pveilleuse:
              const: null
            qp0:
              const: null
            rpn:
              const: null
        required:
          - energie
          - type
          - signaletique
      - title: Générateur thermodynamique
        type: object
        properties:
          energie:
            const: electricite
          type:
            enum:
              - cet_air_ambiant
              - cet_air_exterieur
              - cet_air_extrait
              - pac_double_service
          signaletique:
            type: object
            properties:
              mode_combustion:
                const: null
              presence_ventouse:
                const: null
              pveilleuse:
                const: null
              qp0:
                const: null
              rpn:
                const: null
        required:
          - energie
          - type
          - signaletique
      - title: Générateur mixte
        type: object
        properties:
          energie:
            const: electricite
          type:
            const: pac_double_service
          signaletique:
            type: object
            properties:
              label:
                const: null
        required:
          - energie
          - type
          - signaletique
      - title: Générateur à combustion
        type: object
        properties:
          energie:
            enum:
              - gaz_naturel
              - gpl
              - fioul
              - charbon
              - bois_buche
              - bois_plaquette
              - bois_granule
          signaletique:
            type: object
            properties:
              label:
                const: null
              cop:
                const: null
        required:
          - energie
          - signaletique
      - title: Réseau de chaleur
        type: object
        properties:
          energie:
            const: reseau_chaleur
          signaletique:
            type: object
            properties:
              pn:
                const: null
              label:
                const: null
              cop:
                const: null
              mode_combustion:
                const: null
              presence_ventouse:
                const: null
              pveilleuse:
                const: null
              qp0:
                const: null
              rpn:
                const: null
        required:
          - energie
          - signaletique
  - oneOf:
      - title: Générateur indépendant
        type: object
        properties:
          type:
            enum:
              - accumulateur
              - chauffe_eau_instantane
              - chauffe_eau_vertical
              - chauffe_eau_horizontal
              - cet_air_ambiant
              - cet_air_exterieur
              - cet_air_extrait
          position:
            type: object
            properties:
              generateur_mixte_id:
                const: null
              reseau_chaleur_id:
                const: null
        required:
          - type
          - position
      - title: Générateur mixte
        type: object
        properties:
          type:
            not:
              enum:
                - reseau_chaleur
                - accumulateur
                - chauffe_eau_instantane
                - chauffe_eau_vertical
                - chauffe_eau_horizontal
                - cet_air_ambiant
                - cet_air_exterieur
                - cet_air_extrait
          position:
            type: object
            properties:
              reseau_chaleur_id:
                const: null
        required:
          - type
          - position
      - title: Réseau de chaleur
        type: object
        properties:
          type:
            const: reseau_chaleur
          position:
            type: object
            properties:
              generateur_collectif:
                const: true
              generateur_multi_batiment:
                const: true
        required:
          - type
          - position
  - oneOf:
      - title: Accumulateur
        type: object
        properties:
          type:
            const: accumulateur
          energie:
            enum: [gaz_naturel, gpl]
          signaletique:
            type: object
            properties:
              volume_stockage:
                exclusiveMinimum: 0
        required:
          - type
          - energie
          - signaletique
      - title: Chauffe-eau instantané
        type: object
        properties:
          type:
            const: chauffe_eau_instantane
          energie:
            enum: [gaz_naturel, gpl]
          signaletique:
            type: object
            properties:
              volume_stockage:
                const: 0
                default: 0
        required:
          - type
          - energie
          - signaletique
      - title: Chauffe-eau électrique
        type: object
        properties:
          type:
            enum: [chauffe_eau_vertical, chauffe_eau_horizontal]
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Chaudière électrique
        type: object
        properties:
          type:
            enum:
              - chaudiere
              - chaudiere_murale
              - chaudiere_sol
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Chaudière à combustion
        type: object
        properties:
          type:
            enum:
              - chaudiere
              - chaudiere_murale
              - chaudiere_sol
          energie:
            enum:
              - gaz_naturel
              - gpl
              - fioul
              - charbon
              - bois_buche
              - bois_plaquette
              - bois_granule
        required:
          - type
          - energie
      - title: Chauffe-eau thermodynamique
        type: object
        properties:
          type:
            enum: [cet_air_ambiant, cet_air_exterieur, cet_air_extrait]
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Pompe à chaleur
        type: object
        properties:
          type:
            const: pac_double_service
          energie:
            const: electricite
        required:
          - type
          - energie
      - title: Poêle bouilleur
        type: object
        properties:
          type:
            const: poele_bouilleur
          energie:
            enum: [bois_buche, bois_plaquette, bois_granule]
        required:
          - type
          - energie
      - title: Réseau de chaleur
        type: object
        properties:
          type:
            const: reseau_chaleur
          energie:
            const: reseau_chaleur
        required:
          - type
          - energie
