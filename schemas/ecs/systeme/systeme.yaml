$id: https://schemas.dpe-audit.fr/ecs/systeme
$schema: https://json-schema.org/draft/2020-12/schema
title: Système d'eau chaude sanitaire
type: object
unevaluatedProperties: false
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  generateur_id:
    title: Identifiant du générateur d'eau chaude sanitaire associé au système
    type: string
    format: uuid
  installation_id:
    title: Identifiant de l'installation d'eau chaude sanitaire associée au système
    type: string
    format: uuid
  reseau:
    $ref: "#/$defs/reseau"
  stockage:
    $ref: "#/$defs/stockage"
  data:
    $ref: "#/$defs/data"
required:
  - id
  - description
  - generateur_id
  - installation_id
  - reseau
  - stockage
$defs:
  reseau:
    title: Réseau de distribution d'eau chaude sanitaire
    type: object
    properties:
      alimentation_contigue:
        title: Alimentation contigüe
        type: boolean
      niveaux_desservis:
        title: Nombre de niveaux desservis
        type: integer
        minimum: 1
      isolation:
        title: Isolation du réseau
        type: ["string", "null"]
        enum: [isole, non_isole, null]
        default: null
      bouclage:
        title: Type de bouclage
        type: ["string", "null"]
        enum: [non_boucle, boucle, trace, null]
    required:
      - alimentation_contigue
      - niveaux_desservis
      - isolation
      - bouclage
  stockage:
    title: Stockage indépendant
    type: object
    properties:
      volume:
        title: Volume de stockage en l
        type: [number, "null"]
        minimum: 0
        default: null
      position_volume_chauffe:
        title: Position à l'intérieur volume chauffé
        type: [boolean, "null"]
        default: null
    oneOf:
      - title: Absance de stockage
        properties:
          volume:
            minimumExclusive: 0
          position_volume_chauffe:
            type: boolean
        required:
          - volume
          - position_volume_chauffe
      - title: Sans stockage
        properties:
          volume:
            const: 0
          position_volume_chauffe:
            const: null
        required:
          - volume
      - title: Stockage inconnu
        properties:
          volume:
            const: null
          position_volume_chauffe:
            const: null
  data:
    title: Données calculées
    type: object
    readOnly: true
    properties:
      rdim:
        title: Ratio de dimensionnement
        type: number
      cef_ecs:
        title: Consommation finale d'eau chaude sanitaire en kWh/an
        type: number
      cep_ecs:
        title: Consommation primaire d'eau chaude sanitaire en kWh/an
        type: number
      eges_ecs:
        title: Emissions de gaz à effet de serre d'eau chaude sanitaire en kgCO2/an
        type: number
      cef_aux:
        title: Consommation finale des auxiliaires en kWh/an
        type: number
      cep_aux:
        title: Consommation primaire des auxiliaires en kWh/an
        type: number
      eges_aux:
        title: Emissions de gaz à effet de serre des auxiliaires en kgCO2/an
        type: number
      rendements:
        $ref: "#/$defs/rendements"
      pertes:
        $ref: "#/$defs/pertes"
  rendements:
    title: Rendements
    type: object
    properties:
      iecs:
        title: Inverse du rendement du système
        type: number
      rd:
        title: Rendement de distribution
        type: number
      rs:
        title: Rendement de stockage
        type: number
      rg:
        title: Rendement de génération
        type: number
      rgs:
        title: Rendement de génération et de stockage
        type: number
  pertes:
    title: Pertes
    type: object
    properties:
      pertes_generation:
        title: Pertes de génération en kWh/an
        type: number
      pertes_generation_recuperables:
        title: Pertes de génération récupérables en kWh/an
        type: number
      pertes_stockage_integre:
        title: Pertes de stockage intégré en kWh/an
        type: number
      pertes_stockage_integre_recuperables:
        title: Pertes de stockage intégré récupérables en kWh/an
        type: number
      pertes_stockage_independant:
        title: Pertes de stockage indépendant en kWh/an
        type: number
      pertes_stockage_independant_recuperables:
        title: Pertes de stockage indépendant récupérables en kWh/an
        type: number
      pertes_distribution:
        title: Pertes de distribution en kWh/an
        type: number
      pertes_distribution_recuperables:
        title: Pertes de distribution récupérables en kWh/an
        type: number
