$id: https://schemas.dpe-audit.fr/ventilation/installation
$schema: https://json-schema.org/draft/2020-12/schema
title: Installation de ventilation
type: object
properties:
  id:
    title: Identifiant
    type: string
    format: uuid
  description:
    title: Description
    type: string
  surface:
    title: Surface couverte par l'installation en m²
    type: number
    exclusiveMinimum: 0
  type:
    title: Type de ventilation
    type: string
    enum:
      - ventilation_mecanique
      - ventilation_naturelle_ouverture_fenetres
      - ventilation_naturelle_entrees_air_hautes_basses
      - ventilation_naturelle_conduit
      - ventilation_naturelle_conduit_entrees_air_hygroreglables
  generateur_id:
    title: Identifiant du générateur de ventilation associé au système
    type: [string, "null"]
    default: null
    format: uuid
  data:
    $ref: "#/$defs/data"
required:
  - id
  - description
  - surface
  - type
oneOf:
  - title: Ventilation mécanique
    type: object
    properties:
      type:
        const: ventilation_mecanique
      generateur_id:
        type: string
        format: uuid
    required:
      - type
      - generateur_id
  - title: Ventilation naturelle
    type: object
    properties:
      type:
        enum:
          - ventilation_naturelle_ouverture_fenetres
          - ventilation_naturelle_entrees_air_hautes_basses
          - ventilation_naturelle_conduit
          - ventilation_naturelle_conduit_entrees_air_hygroreglables
      generateur_id:
        const: null
    required:
      - type
$defs:
  data:
    title: Données calculées
    type: object
    readOnly: true
    properties:
      rdim:
        title: Ratio de dimensionnement de l'installation
        type: number
      qvarep_conv:
        title: Débit volumique conventionnel à reprendre en m3/(h.m²)
        type: number
      qvasouf_conv:
        title: Débit volumique conventionnel à souffler en m3/(h.m²)
        type: number
      smea_conv:
        title: Somme des modules d'entrée d'air sous 20 Pa par unité de surface habitable en m3/(h.m²)
        type: number
      consommations:
        $ref: /common/consommations
